//Import AWS
import { SageMakerRuntimeClient, InvokeEndpointCommand } from "@aws-sdk/client-sagemaker-runtime"; 

//Create SageMakerRuntimeClient
const client = new SageMakerRuntimeClient({});

const endpointData = {
    "instances":
      [
        {"start":"2023-12-22 00:00:00","target":[214.73831000,214.65910000,209.51045000,211.41149000,235.80817000,256.71961000,255.53146000,248.48177000,251.17491000,246.97678000,248.32335000,247.29362000,250.14518000,256.40277000,251.49175000,243.57075000,239.53104000,240.56077000,238.50131000,242.22418000,244.12522000,234.93686000,239.37262000,237.23395000,251.49175000,249.66992000,245.07574000,247.92730000,249.27387000,251.25412000,252.36306000,242.30339000,236.67948000,232.16451000,231.37241000,239.37262000,242.06576000,241.82813000,246.10547000,243.64996000,238.02605000,237.78842000,238.73894000,237.39237000,241.35287000,238.58052000,239.76867000,243.41233000,252.83832000,256.64040000,255.84830000,254.02647000,259.65038000,257.19487000,264.48219000,280.56182000,285.47284000,279.53209000,277.07658000,278.50236000,280.87866000,300.36432000,303.05746000,297.43355000,302.34457000,307.73085000,318.10736000,312.56266000,328.40466000,316.36474000,322.70154000,325.47389000,328.32545000,331.41464000,312.16661000,340.12774000,375.93066000,384.80218000,386.78243000,418.94169000,414.26830000,425.75375000,499.41905000,477.79472000,501.16167000,456.56644000,452.84357000,439.93234000,402.14917000,441.04128000,438.66498000,438.66498000,437.15999000,449.67517000,464.96270000,459.73484000,454.90303000,462.11114000,485.16125000,478.58682000]}
      ],
      "configuration":
         {
           "num_samples": 50,
            "output_types":["mean","quantiles","samples"],
            "quantiles":["0.1","0.9"]
         }
  }

//Calls endpoint and logs results
async function invokeEndpoint () {
    //Create and send command with data
    const command = new InvokeEndpointCommand({
        EndpointName: "bnbEndpoint",
        Body: JSON.stringify(endpointData),
        ContentType: "application/json",
        Accept: "application/json"
    });
    const response = await client.send(command);

    //Must install @types/node for this to work
    let predictions = JSON.parse(Buffer.from(response.Body).toString('utf8'));
    console.log(predictions);
    console.log(JSON.stringify(predictions));
}

invokeEndpoint();